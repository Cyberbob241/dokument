\chapter{Diskussion}

	Neben der Beantwortung der initial formulierten Forschungsfragen wird innerhalb dieses Abschnittes eine komprimierte Analyse von Limitierungen der finalen Themenbetrachtung vorgenommen, welche die Deduktion weiterführender Forschungsansätze ermöglicht.

	\section{Beantwortung der Forschungsfragen}
	
		Als Leitlinien dieser Arbeit wurden in Abschnitt 1.2 drei zentrale Forschungsfragen formuliert, welche im Folgenden auf Basis der Arbeitsergebnisse diskutiert werden sollen. \\
		
		\noindent\textbf{1. Welche Verfahren zur Analyse von Malware-Implementierungen existieren und welche Relevanz besitzen virtuelle Systeme in diesem Kontext?}\\
		
		\begin{addmargin}[1em]{0em}
			Aus konzeptioneller Perspektive können die Verfahren zur Examination von Malware-Realisierungen grobgranular in zwei wesentliche Ansätze differenziert werden. Die \textit{statische Malware-Analyse} realisiert dabei die Evaluation von akquirierten Implementierungs-Fragmenten, um final wesentliche Parameter der Malware-Funktionalität rekonstruieren zu können. Hierzu sind aufgrund der zunehmenden Verbreitung von kryptographischen Algorithmen und Obfuscation-Techniken oftmals extensive Analysen der Quellcode-Exzerpten erforderlich, was final häufig in der Notwendigkeit zur manuellen Durchführung resultiert.			
			Der alternative Ansatz der \textit{dynamischen Malware-Analyse} priorisiert hingegen die Analyse des Laufzeit-Verhaltens eines Malware-Implementierung, welches unter Verwendung dedizierter Protokoll- und Monitoringmechanismen detailliert aufgezeichnet wird. Um die Kompromittierung produktiver Systeme weitestgehend ausschließen zu können, werden die dynamischen Analyseansätze in der Regel innerhalb isolierter Systemumgebungen realisiert.			
			Häufig wird zur Elimination der individuellen Ansatz-Defizite jedoch ein hybrider Ansatz genutzt, welcher die adaptive Kombination von konzeptionellen Maßnahmen der statischen und dynamischen Analysemethoden im Hinblick auf die konkrete Analyseproblematik ermöglicht.\\
			\noindent Virtualisierte Systemumgebungen repräsentieren in diesem Kontext das primäre Instrument zur Realisierung der konkreten Analysemethoden, indem sie den Betrieb multipler Evaluationsumgebungen sowie deren dynamische Rekonfiguration in strikter Isolation von potentiellen Produktivsysteme offerieren. 
			Aufgrund des koordinierendes Hypervisor-Elements, welches die Separation der emulierten Systemelemente von physischen Hardware-Komponenten realisiert, wird insbesondere die detaillierte Protokollierung von internen Systemaufrufen und etwaiger Netzwerkkommunikation ermöglicht. Unter Verwendung der Hypervisor-Schnittstellen können dabei wesentlich detaillierte Informationen extrahiert werden, als in physischen Host-System möglich wäre \textcolor{red}{[11]}. %https://books.google.de/books?id=hrSoCAAAQBAJ&pg=PA17&lpg=PA17&dq=less+vm+detection&source=bl&ots=KqJDeb-Nho&sig=YFe6waQMlr4Qhd1gvDu72OlBQBY&hl=de&sa=X&ved=0ahUKEwjP-rOZ5OzZAhXMjSwKHdzNCUkQ6AEIUTAF#v=onepage&q=gain%20popul&f=false
			Ein weiteres, zentrales Argument zur Nutzung virtueller Systeme im Kontext der Malware-Analyse ist die im Vergleich zu Realsystemen signifikant simplifizierte Konfiguration der Guest-Systeme. Dies ermöglicht die vergleichsweise einfache Konstruktion von komplexen Netzwerk-Umgebungen sowie die Emulation beliebiger Hardware-Subsysteme, sodass der zur Evaluation einer Malware-Implementierung erforderliche Systemkontext individuell konfiguriert werden kann.
			Unter Berücksichtigung der zunehmenden Dominanz virtualisierter Systeme in produktiven Einsatzszenarien (exemplarisch sei an dieser Stelle der Webserver-Betrieb referenziert \cite{presentation}) werden auch diese vermehrt Ziel von Malware-Angriffen. Vor dem Hintergrund garantiert die reine Verwendung virtueller Systeme keine Sicherheit vor der möglichen Kompromittierung des Systems, sodass auch hier \makebox[\linewidth][s]{dedizierte Sicherheitsmaßnahmen zur Infektionsabwehr konzipiert werden müssen.}
			
		\end{addmargin}	
		\vspace{\baselineskip}
		
		\noindent\textbf{2. Welche systemspezifischen Indizien werden von aktuellen Malware-\\\noindent Implementierungen zur Detektion virtueller Systemumgebungen eingesetzt?}\\
		
		\begin{addmargin}[1em]{0em}
			Auf Basis einer initialen Evaluation der von Virtualisierungs-Implementierungen induzierten System-Anomalien wurden dieser einer grobgranularen Kategorisierung hinsichtlich der intern verwendeten Mechanismen unterzogen. Hierzu wurde eine Differenzierung in vier Subkategorien realisiert, deren Anteile im Verlauf des dedizierten Abschnittes \ref{cha:Virtualisierung} hinsichtlich potentieller Detektionsvektoren analysiert wurden. 
			\noindent Die erste Kategorie priorisiert dabei die Identifikation kompromittierender Namensattribute innerhalb verschiedener Betriebssystem-Implementierungen. In Unix-basierten Systemumgebungen kann diese aufgrund der \textit{everything-is-a-file}-Architektur meist bereits durch die Validierung der Existenz bestimmter Dateifragmente oder Verzeichnisse realisiert werden, wobei zusätzlich eine extensive Analyse selektiv vorgefilterter Dateiinhalte realisiert werden kann. Das konzeptionelle Analogon zu verteilten, dateibasierten Konfigurationsdaten 
			wird in Windows-Systemen durch die zentralisierte Registry-Datenbank repräsentiert, welche in ihrer Rolle als universelles Informationselement des Systems auch die Extraktion von potentiellen Virtualisierungs-Indikatoren erlaubt. \\ %wesentlicher Parameter der Systemkonfiguration erlaubt.\\ 
			\noindent Innerhalb der zweiten Kategorie wird die Extraktion von Laufzeit-Attributen aus der virtuellen Hauptspeicher-Komponente forciert. Aufgrund des interaktiven Charakters verschiedener Anteile einer virtuellen Systemumgebung sind innerhalb des System-RAMs oftmals Fragmente der Treiber- oder Hypervisor-Funktionalität mit entsprechenden Namensattributen abgelegt, deren Existenz aufgrund der dynamischen Speicherkomposition jedoch nur unter relativ hohem Aufwand validiert werden kann.\\
			Ein zentraler Indikator für die Präsenz von virtualisierten Systemumgebungen wird durch emulierte Hardware-Komponenten repräsentiert, welche in Kategorie drei analysiert wurden. Zur Realisierung des interaktiven Simulationsbetriebs zwischen dem physischen Host-System und virtualisierten Guest-Instanzen ist die Implementierung spezialisierter Treiberfunktionalität erforderlich, wobei die Parameter der hierzu verwendeten Komponenten häufig die Deduktion des virtuellen Systemcharakters erlauben.\\ 
			\noindent Final wurde in Kategorie vier die Evaluation von direkten CPU-Instruktionen hinsichtlich ihrer Verwendbarkeit im Kontext der Virtualisierungs-Detektion vorgenommen. Obwohl die Struktur des CPU-Befehlssatzes stark architekturspezifisch ist und somit die feingranulare Anpassung der Detektionsvektoren an das Zielsystem erfordert, bietet sich aufgrund der geringen Interferenzen von CPU-Instruktionen mit Betriebssystem-Implementierungen der Einsatz als additiver Indikator grundsätzlich an. In der Realität werden die hier präsentierten Detektionsansätze zur Ausgleichung individueller Defizite meist kombiniert eingesetzt, wobei insbesondere eine stufenweise Validierung der \makebox[\linewidth][s]{generierten Resultate durch Kategorie-übergreifende Methoden zu beobachten ist.}
		\end{addmargin}
		\vspace{\baselineskip}
		
		\noindent\textbf{3. Welche Methoden und Verfahren können zur Optimierung der in einem virtuellen System generierten Analyse-Resultate eingesetzt werden?}\\
		
		\begin{addmargin}[1em]{0em}
			\textcolor{red}{OSTENDORFF}				
		\end{addmargin}
	
	\section{Limitierungen der aktuellen Betrachtung}
	
		Im Rahmen dieser Seminararbeit wurden die Analyseparameter auf die abstrahierte Betrachtung von generischen Malware-Implementierungen ausgerichtet. Die in produktiven Systemumgebungen eingesetzten Derivate weisen jedoch mitunter signifikante Diskrepanzen	 in Implementierung und Verhalten auf; so ist beispielsweise bei hybriden Botnetz-Implementierungen konzeptionsgemäß ein hoher Kommunikationsanteil evident, während Rootkit-Installationen primär verdeckt agieren und dedizierten Detektionmaßnahmen daher kaum Angriffsoberfläche bieten.
		Bei der Konzeption konkreter Analyseumgebungen zur Untersuchung spezifischer Malware-Samples ist daher eine initiale Grobanalyse zur Deduktion der durch das Malware-Derivat verwendeten Evasionstechniken zu empfehlen, welche beispielsweise auf Basis von Untersuchungen verwandter Malware-Familien realisiert werden kann. Darauf aufbauend wird final die feingranulare Adaption der malwareinhärenten Evasionsmethoden zur Konzeption der korrespondierenden Gegenmaßnahmen umgesetzt, welche final in der Generierung optimierter Analyse-Resultate resultiert. Diese Form der malwarespezifischen Optimierung der verwendeten Analyseumgebung findet zugunsten einer abstrahierten Perspektive, welche die Abdeckung generischer Malware-Implementierungen erlaubte, im Rahmen dieser Arbeit nur in Ansätzen Berücksichtigung. 
		\noindent In diesem Kontext gestaltet sich insbesondere die Konfiguration automatisierter Analyseumgebungen als äußerst diffizil, sodass die feingranulare (eventuell malwareindividuelle) Betrachtung einzelner Parameter meist manuell realisiert werden muss. Eine exhaustive Implementierung von Gegen- und Optimierungsmaßnahmen ist dabei im Regelfall kaum möglich, da aufgrund der in Abschnitt \ref{sec:konzept} konstatierten Diversifizierung sowie der zunehmenden Entwicklung von adaptiven Detektionsmaßnahmen durch Malware-Entwickler die Komplexität kontinuierlich ansteigt. Aus diesem Grund ist auch auf Seiten der Gegenmaßnahmen eine auf den Analysekontext angepasste, strategische  Kombination der individuellen Optimierungsmethoden erforderlich, deren Konfiguration individuell auf die untersuchten Malware-Komponenten angepasst werden muss. \\
		\noindent Ausgehend von den im Rahmen der Seminararbeit präsentierten, virtualisierten Systemumgebungen wurden durch Sicherheitsanalysten dedizierte Sandbox- und Analysesysteme für den Einsatz im Kontext der Malware-Analyse konzipiert. Diese implementieren neben der Hypervisor-basierten Systemisolation auch interne Maßnahmen zur effektiven Verschleierung der VM-Präsenz sowie dedizierte Protokoll- und Überwachungsfunktionalität. Exemplarisch wurden im Verlauf der initialen Kontextualisierung \textit{Cuckoo} und \textit{Cisco Threat Grid} referenziert, wobei ausgehend von der Schwerpunktsetzung dieser Arbeit auf eine detaillierte Examination der stark spezialisierten Systemumgebungen verzichtet wurde. Aufgrund der zunehmenden Verbreitung von virtuellen Systemen im produktiven Serverbetrieb ist hierbei jedoch eine feingranulare Differenzierung zwischen den System-Kategorien \textit{virtualisierte Systemumgebung} und \textit{dedizierte Analyseumgebung} erforderlich. Aktuelle Malware-Implementierung entwickeln in diesem Kontext gemäß der Ausführungen in Abschnitt \ref{sec:wkt} bereits zuverlässige Kompetenzen \cite{fortinet2}. %Quelle:https://blog.fortinet.com/2018/01/03/prevalent-threats-targeting-cuckoo-sandbox-detection-and-our-mitigation
				
		%Aufbauend aus virtualisierten Systemkontext oder Software-Sandbox dedizierte ANalysesysteme konzipiert, welche neben Maßnahmen zur verschleireung der VM-Präsenz dedizierte Protokoll- und Überwachungsfunktionalitä implementier. Diese im rhmen dieser arbeit nichtdediizert analysiert; aufgrund zunehmender VErbreitung virtueller Systeme im Kontexdt des produktiven Betriebs feingranulare Differenzuerunig zwischen virtuellen Systemen und dedizieren NAalysesystem erforderlich. Malware entwickelt in diesem kOntext allmählich Kompentenzen \textcolor{red}{[11]}%Quelle:https://blog.fortinet.com/2018/01/03/prevalent-threats-targeting-cuckoo-sandbox-detection-and-our-mitigation
		
		\noindent Die zunehmende Omnipräsenz digitaler Systeme manifestiert sich primär in den wachsenden Sektoren der Mobilgeräte sowie im Kontext des \textit{Internet of Things} (IoT), dessen Forcierung der ubiquitären Vernetzung von Alltagsgeständen die Anzahl zu schützender System massiv erhöht. Im Rahmen dieser Seminararbeit wurde der Fokus auf die Untersuchung Desktop-basierter Virtualisierungs-Lösungen gelegt, sodass die Malware-Analyse von Mobilgeräten und IoT-Komponenten (sowie potentiellen Beiträgen der Virtualisierungstechnologie in diesem Bereich) nicht betrachtet wurden. Des Weiteren verfügen auch moderne Browser-Implementierungen zunehmend über isolierte Software-Sandboxes, um die mit potentiell kompromittieren Webinhalten interagierende Browser-Komponente vom Rest des Produktivsystems zu isolieren. Da die Realisierung dieser Mechanismen jedoch weitestgehend systemspezifisch ist, wurden Detektionsmaßnahmen für diese Technologie im thematischen Kontext der vorliegenden Seminararbeit bewusst nicht berücksichtigt.
		